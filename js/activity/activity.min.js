function checkIfExistsActivity(){var e=$("input[name=name]").val();$.ajax({success:function(e){return printResponse(e),e.exists?($("input[name=name]").val(""),simpleToastr("Hey!","Já existe uma ativade igual.","warning"),!1):!0},error:function(e){printResponse(e),simpleToastr("Oops!","Algo deu errado! Tente novamente.","error")},url:prefixUrl+"/activity/checkIfExistsActivity",type:"POST",data:{name:e,"form-submitted":"true"},dataType:"json"})}function buildActivityFormSubmit(){"undefined"==typeof localStorage.edit&&$("#activity-form").ajaxForm({beforeSubmit:function(){checkIfExistsActivity(),$("button[name=submit]").button("loading")},success:function(e){printResponse(e),e.successful?simpleToastr("Yay!","Atividade adicionada com sucesso! :D","success"):simpleToastr("Oops!","Algo deu errado! Tente novamente.","error"),$("button[name=submit]").button("reset")},error:function(e){printResponse(e),simpleToastr("Oops!","Algo deu errado! Tente novamente.","error"),$("button[name=submit]").button("reset")},url:prefixUrl+"/activity/saveNew",type:"POST",dataType:"json",clearForm:!0,resetForm:!0})}function buildActivityEditFormSubmit(){"undefined"!=typeof localStorage.edit&&($("input[name=id]").val(localStorage.id),$("input[name=name]").val(localStorage.name),$("textarea[name=description]").html(localStorage.description),$("option[value="+localStorage.type+"]").attr("selected","selected"),$("input[name=duration]").val(localStorage.duration),$("textarea[name=goal]").html(localStorage.goal),$("textarea[name=requirement]").html(localStorage.requirement),$("button[name=submit]").html("Editar"),$("button[name=submit]").attr("data-loading-text","Editando..."),$("#activity-form").ajaxForm({beforeSubmit:function(){checkIfExistsActivity(),$("button[name=submit]").button("loading")},success:function(e){printResponse(e),e.successful?(lastPage=localStorage.lastPage,delete localStorage.lastPage,simpleAlert("Yay!","Atividade editada com sucesso! :D","success",function(){window.location.href=lastPage})):simpleToastr("Oops!","Algo deu errado! Tente editar novamente.","error"),$("button[name=submit]").button("reset")},error:function(e){printResponse(e),simpleToastr("Oops!","Algo deu errado! Tente editar novamente.","error"),$("button[name=submit]").button("reset")},url:prefixUrl+"/activity/edit",type:"POST",dataType:"json",clearForm:!0,resetForm:!0}),delete localStorage.edit,delete localStorage.id,delete localStorage.name,delete localStorage.description,delete localStorage.type,delete localStorage.duration,delete localStorage.goal,delete localStorage.requirement)}function buildFormValidate(){$("#activity-form").validate({rules:{name:{required:!0,maxlength:50},description:{required:!0},especificacoes:{required:!0},type:{required:!0},duration:{required:!0,digits:!0},goal:{required:!0}}})}function buildActivityEdit(){$(".edit").on("click.edit",function(e){e.preventDefault();var t=$(this).attr("activity");editActivity(t)})}function buildActivityDelete(){$(".delete").on("click.delete",function(e){e.preventDefault();var t=$(this).attr("activity");confirmAlert("Tem certeza?","A atividade será apagada pra sempre!","warning","Tenho certeza!",deleteActivity,t)})}function editActivity(e){$.ajax({success:function(e){printResponse(e),e.successful&&(localStorage.edit=!0,localStorage.id=e.id,localStorage.name=e.name,localStorage.description=e.description,localStorage.type=e.type,localStorage.duration=e.duration,localStorage.goal=e.goal,localStorage.requirement=e.requirement,localStorage.lastPage=window.location.href.split("/").last(),window.location.href="edit")},error:function(e){printResponse(e),simpleToastr("Oops!","Algo deu errado! Tente editar novamente.","error")},url:prefixUrl+"/activity/selectById",type:"POST",data:{id:e,"form-submitted":"true"},dataType:"json"})}function deleteActivity(e){$.ajax({success:function(t){printResponse(t),t.successful&&(simpleToastr("Yay!","Atividade foi excluida por toda eternidade!","success"),$("div[activity="+e+"]").remove())},error:function(e){printResponse(e),simpleToastr("Oops!","Algo deu errado! Tente deletar novamente.","error")},url:prefixUrl+"/activity/delete",type:"POST",data:{id:e,"form-submitted":"true"},dataType:"json"})}"undefined"==typeof localStorage.edit&&window.location.href.indexOf("edit")>=0&&(window.location.href="add"),$(document).ready(function(){buildFormValidate(),buildActivityFormSubmit(),buildActivityEditFormSubmit(),buildActivityEdit(),buildActivityDelete(),$("input[name=name]").on("blur",function(){"undefined"==typeof localStorage.edit&&checkIfExistsActivity()})});